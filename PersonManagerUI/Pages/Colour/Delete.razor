@page "/data/colour/delete/{ColourId:int}"

@using DataAccessLibrary.Interfaces
@using DataAccessLibrary.Models
@using PersonManagerUI.Components

@inject IColourData _colourDb
@inject NavigationManager _navigationManager

<h1>Delete</h1>

@if (OkToDelete)
{
    <h4 style="color: red">Are you sure you want to delete this colour?</h4>
}
else
{
    <h4 style="color: red">Cannot delete colour when people have it as their favourite</h4>
}

<ColourDetails Colour="colour" />

@if (OkToDelete)
{
    <button class="btn btn-danger" @onclick="DeleteColour">Delete</button>
}
<a href="data/colours/index/">Cancel</a>

@code {

    [Parameter]
    public int ColourId { get; set; }

    public ColourModel colour = new();

    public bool OkToDelete = true;

    protected override void OnInitialized()
    {
        colour = _colourDb.GetColour(ColourId);

        if (colour.People.Count > 0)
        {
            OkToDelete = false;
        }
    }

    private void DeleteColour()
    {
        _colourDb.DeleteColour(ColourId);

        _navigationManager.NavigateTo("data/colours/index");
    }
}
