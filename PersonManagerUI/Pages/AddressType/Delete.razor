@page "/data/addresstype/delete/{AddressTypeId:int}"

@using DataAccessLibrary.Interfaces
@using DataAccessLibrary.Models
@using System.Diagnostics

@inject IAddressTypeData _addressTypeDb
@inject NavigationManager _navigationManager

<h1>Delete</h1>

@if (OkToDelete)
{
    <h4 style="color: red">Are you sure you want to delete this address type?</h4>
}
else
{
    <h4 style="color: red">Cannot delete address type when it is being used in an address</h4>
}

<table class="table table-striped">
    <tbody>
    <tr>
        <td><strong>Address Type Name</strong></td>
        <td>@addressType.AddressTypeName</td>
    </tr>
    </tbody>
</table>

@if (OkToDelete)
{
    <button class="btn btn-danger" @onclick="DeleteAddressType">Delete</button>
}

<a href="data/addresstypes/index">Cancel</a>

@code {

    [Parameter]
    public int AddressTypeId { get; set; }

    private AddressTypeModel addressType = new AddressTypeModel();

    private bool OkToDelete = true;

    protected override void OnInitialized()
    {
        addressType = _addressTypeDb.GetAddressType(AddressTypeId);

        if (addressType.Addresses.Count > 0)
        {
            OkToDelete = false;
        }
    }

    private void DeleteAddressType()
    {
        _addressTypeDb.DeleteAddressType(AddressTypeId);

        _navigationManager.NavigateTo("/data/addresstypes/index");
    }
}
